<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vintélo</title>
    <link rel="stylesheet" href="css/perfilvender.css">

    <link rel="icon" href="/imagens/brilhoescuro.png" type="image/x-icon">
    
</head>
<body>

    <section class="oculto-mobile">
        <header-1>
            <section class="top-bar">
                <p>10% OFF na primeira compra</p>
            </section>
            <section class="main-header">
                <a href="/homevendedor">
                <img src="imagens/logo.png" class="img-logo">
                </a>
                <nav>
                    <a href="/categorias">Vestidos</a>
                    <a href="/categorias">Saias</a>
                    <a href="/categorias">Blusas</a>
                    <a href="/categorias">Calças</a>
                    <a href="/categorias">Categorias</a>
                </nav>
                <section class="search-profile">
                    <form>
                        <input type="text" placeholder="Buscar...">
                    </form>
                    <ul>
                        <li><a href="#" ></a><img src="imagens/icone saco.png" class="img-tamanho"> </li>
                        <li><a href="/menuvendedor" ><img src="<%= brecho && brecho.imagem ? brecho.imagem : '/imagens/icone sem cadastro.png' %>" class="img-tamanho"></a></li>
                        <li><a href="#" ><img src="imagens/icone coraçao.png" class="img-tamanho"> </a></li>
                    </ul>
                </section>
            </section>
          </header>
    </section>

    <section class="oculto-desktop">
    <header>
        <nav class="grid">
          <a href="/homevendedor">
           <img src="imagens/seta.png" alt="Seta Voltar">
          </a>
          <img src="imagens/logo.png" alt="Logo">
          <a href="/planos">
           <img src="imagens/icone premium.png" alt="Premium">
          </a>
        </nav>
    </header>
    </section>

    <main>
        <section class="header-container">
            <section class="profile-section">
                <img src="<%= brecho && brecho.imagem ? brecho.imagem : '/imagens/icone sem cadastro.png' %>" alt="<%= brecho ? brecho.nome : 'Loja' %>" class="profile-img">
                <section class="profile-info">
                    <h1><%= brecho ? brecho.nome : 'Nome do Brechó' %></h1>
                    <span class="rating"><%= brecho && brecho.avaliacao ? brecho.avaliacao : '0.0' %> ★★★★★</span>
                </section>
                <a href="/informacao" class="edit-button">✎ Editar</a>
            </section>
        </section>
        
        <section class="store-section">
            <section class="store-info">
                <span><%= brecho && brecho.itens_venda ? brecho.itens_venda : '0' %> à venda</span>
                <span><%= brecho && brecho.vendidos ? brecho.vendidos : '0' %> vendidos</span>
                <span><%= brecho && brecho.seguidores ? brecho.seguidores : '0' %> seguidores</span>
            </section>
            <section class="product-grid">
                <!-- Adicione os produtos conforme o layout -->
            </section>
        </section>

        <section class="container">
            <section class="oculto-mobile">
              <section class="filtro">
                <details open>
                    <summary>Categorias</summary>
                    <section class="categories-grid">
                        <button class="category-btn active" data-category="todos">Todos</button>
                        <button class="category-btn" data-category="vestidos">Vestidos</button>
                        <button class="category-btn" data-category="blusas">Blusas</button>
                        <button class="category-btn" data-category="calcas">Calças</button>
                        <button class="category-btn" data-category="saias">Saias</button>
                        <button class="category-btn" data-category="acessorios">Acessórios</button>
                        <button class="category-btn" data-category="calcados">Calçados</button>
                        <button class="category-btn" data-category="casacos">Casacos</button>
                        <button class="category-btn" data-category="conjuntos">Conjuntos</button>
                        <button class="category-btn" data-category="plus-size">Plus Size</button>
                    </section>
                </details>
                <details open>
                    <summary>Ordenar por</summary>
                    <ul>
                        <li onclick="sortProducts('recent')">Mais recentes</li>
                        <li onclick="sortProducts('price-low')">Menor preço</li>
                        <li onclick="sortProducts('price-high')">Maior preço</li>
                        <li onclick="sortProducts('popular')">Mais populares</li>
                    </ul>
                </details>
                <details open>
                    <summary>Valor</summary>
                    <section class="faixa-valor">
                        <label for="min">Min</label>
                        <input type="range" id="min" min="0" max="500" value="10" oninput="updatePriceRange()">
                        <label for="max">Max</label>
                        <input type="range" id="max" min="0" max="500" value="300" oninput="updatePriceRange()">
                    </section>
                    <section class="valores">
                        <input type="text" id="min-value" placeholder="10" onchange="filterByPrice()">
                        <input type="text" id="max-value" placeholder="300" onchange="filterByPrice()">
                    </section>
                </details>
                <details open>
                    <summary>Tamanhos</summary>
                    <section class="sizes-grid">
                        <button class="size-btn" data-size="pp">PP</button>
                        <button class="size-btn" data-size="p">P</button>
                        <button class="size-btn" data-size="m">M</button>
                        <button class="size-btn" data-size="g">G</button>
                        <button class="size-btn" data-size="gg">GG</button>
                        <button class="size-btn" data-size="xgg">XGG</button>
                    </section>
                </details>
                <details>
                    <summary>Condição</summary>
                    <ul>
                        <li><input type="checkbox" id="novo"> <label for="novo">Novo</label></li>
                        <li><input type="checkbox" id="seminovo"> <label for="seminovo">Seminovo</label></li>
                        <li><input type="checkbox" id="usado"> <label for="usado">Usado</label></li>
                    </ul>
                </details>
                <button class="button-filtro" onclick="applyFilters()">APLICAR FILTROS</button>
                <button class="clear-filters" onclick="clearFilters()">Limpar Filtros</button>
            </section>
            </section>

        <section class="products-section">
                <!-- Adicionar Item -->
                <section class="add-item">
                      <a href="/adicionar"><img src="imagens/add.png" alt="Adicionar Item" class="img-add"></a> 
                        <p class="titulo-add">Adicionar Item à loja</p>
                </section>
                
                <!-- Produtos Dinâmicos -->
                <% if (typeof produtos !== 'undefined' && produtos.length > 0) { %>
                  <% produtos.forEach(function(produto) { %>
                    <article class="product-card" data-category="<%= produto.TIPO_PRODUTO ? produto.TIPO_PRODUTO.toLowerCase() : 'outros' %>">
                        <a href="/produto/<%= produto.ID_PRODUTO %>">
                            <img src="<%= produto.URL_IMG ? produto.URL_IMG : 'imagens/produto-default.png' %>" alt="<%= produto.NOME_PRODUTO %>">
                        </a>
                        <h2><%= produto.NOME_PRODUTO %></h2>
                        <p class="price">R$<%= parseFloat(produto.PRECO || 0).toFixed(2).replace('.', ',') %></p>
                        <p class="descricao">ou em 2x de R$<%= (parseFloat(produto.PRECO || 0) / 2).toFixed(2).replace('.', ',') %></p>
                        <button class="favorite" onclick="toggleFavorite(this, <%= produto.ID_PRODUTO %>)"><img src="imagens/coraçao de fav2.png"></button>
                        <button class="cart-btn" onclick="addToCart(<%= produto.ID_PRODUTO %>)"><img src="imagens/sacola.png" alt="Adicionar ao carrinho"></button>
                    </article>
                  <% }); %>
                <% } else { %>
                  <p class="no-products">Nenhum produto cadastrado ainda. <a href="/adicionar">Adicione seu primeiro produto!</a></p>
                <% } %>
            </section>
        </section>

    </main>
    
    <br><br>

    <footer class="footer">
        <img src="imagens/logo2.jpeg" alt="Logo" class="footer-image">
        <section class="social-media">
            <p>Siga nossas redes sociais</p>
            <br>
            <ul class="social-links">
                <li><a href="https://facebook.com" target="_blank"><img src="imagens/Facebook.png" alt="Facebook"></a></li>
                <li><a href="https://instagram.com" target="_blank"><img src="imagens/Instagram.png" alt="Instagram"></a></li>
                <li><a href="https://pinterest.com" target="_blank"><img src="imagens/Pinterest.png" alt="Pinterest"></a></li>
            </ul>
        </section>
        <p class="copyright">© 2024, Vintélo. Todos os direitos reservados.</p>
    </footer>

    <script>
        window.isAuthenticated = <%= typeof autenticado !== 'undefined' && autenticado && autenticado.autenticado ? 'true' : 'false' %>;
        
        // Filtros e ordenação
        function sortProducts(type) {
            const products = document.querySelectorAll('.product-card');
            const container = document.querySelector('.products-section');
            const addItem = container.querySelector('.add-item');
            const productsArray = Array.from(products);
            
            productsArray.sort((a, b) => {
                const priceA = parseFloat(a.querySelector('.price').textContent.replace('R$', '').replace(',', '.'));
                const priceB = parseFloat(b.querySelector('.price').textContent.replace('R$', '').replace(',', '.'));
                
                switch(type) {
                    case 'price-low': return priceA - priceB;
                    case 'price-high': return priceB - priceA;
                    default: return 0;
                }
            });
            
            container.innerHTML = '';
            container.appendChild(addItem);
            productsArray.forEach(product => container.appendChild(product));
        }
        
        function filterByCategory(category) {
            const products = document.querySelectorAll('.product-card');
            products.forEach(product => {
                const productCategory = product.dataset.category || 'outros';
                product.style.display = (category === 'todos' || productCategory === category) ? 'block' : 'none';
            });
        }
        
        function applyFilters() {
            const activeCategory = document.querySelector('.category-btn.active')?.dataset.category || 'todos';
            filterByCategory(activeCategory);
        }
        
        function clearFilters() {
            document.querySelectorAll('.category-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector('[data-category="todos"]').classList.add('active');
            filterByCategory('todos');
        }
        
        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            document.querySelectorAll('.category-btn').forEach(btn => {
                btn.addEventListener('click', function() {
                    document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
                    this.classList.add('active');
                    filterByCategory(this.dataset.category);
                });
            });
        });
    </script>
    <script src="/js/favoritos-global.js"></script>
    <script src="/js/carrinho-global.js"></script>
    <script src="/js/busca-global.js"></script>
</body>
</html>